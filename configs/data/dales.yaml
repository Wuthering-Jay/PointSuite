# DALES 数据集配置
# 
# DALES (Dayton Annotated LiDAR Earth Scan) 数据集
# 8 类语义分割任务

# ========================================================================
# 数据路径
# ========================================================================
train_data: E:/data/DALES/dales_las/bin_logical/train
val_data: E:/data/DALES/dales_las/bin_logical/val
test_data: E:/data/DALES/dales_las/bin_logical/test
predict_data: E:/data/DALES/dales_las/bin_logical/test

# ========================================================================
# 类别配置
# ========================================================================
# 类别映射: 原始标签 -> 训练标签
# 列表形式: [1, 2, 3, 4, 5, 6, 7, 8] 自动映射为 [0, 1, 2, ..., 7]
# 字典形式: {1: 0, 2: 1, ...} 显式指定映射
class_mapping: [1, 2, 3, 4, 5, 6, 7, 8]
class_names: ['地面', '植被', '车辆', '卡车', '电线', '篱笆', '杆状物', '建筑']
num_classes: 8
ignore_label: -1

# ========================================================================
# 数据加载配置
# ========================================================================
# 加载的属性
assets: ['coord', 'class', 'echo']

# 采样模式配置
mode: grid            # 'grid' 或 'full'
max_loops: null       # test/predict 时最大采样轮数

# DataLoader 配置
batch_size: 4
num_workers: 4
pin_memory: true
persistent_workers: true
prefetch_factor: 2

# 动态批次配置
use_dynamic_batch: true
max_points: 125000              # 训练时批次点数
use_dynamic_batch_inference: true
max_points_inference: 125000    # 推理时批次点数

# 加权采样
use_weighted_sampler: true

# 循环配置 (数据增强)
train_loop: 5
val_loop: 5
test_loop: 1
predict_loop: 1

# ========================================================================
# 数据增强配置
# ========================================================================
train_transforms:
  - class_path: pointsuite.data.transforms.CenterShift
  - class_path: pointsuite.data.transforms.RandomDropout
    init_args:
      dropout_ratio: 0.2
      p: 0.5
  - class_path: pointsuite.data.transforms.RandomRotate
    init_args:
      angle: [-1, 1]
      axis: z
      p: 0.5
  - class_path: pointsuite.data.transforms.RandomScale
    init_args:
      scale: [0.9, 1.1]
  - class_path: pointsuite.data.transforms.RandomFlip
    init_args:
      p: 0.5
  - class_path: pointsuite.data.transforms.RandomJitter
    init_args:
      sigma: 0.005
      clip: 0.02
  - class_path: pointsuite.data.transforms.Collect
    init_args:
      keys: ['coord', 'class']
      feat_keys:
        feat: ['coord', 'echo']
  - class_path: pointsuite.data.transforms.ToTensor

val_transforms:
  - class_path: pointsuite.data.transforms.CenterShift
  - class_path: pointsuite.data.transforms.Collect
    init_args:
      keys: ['coord', 'class']
      feat_keys:
        feat: ['coord', 'echo']
  - class_path: pointsuite.data.transforms.ToTensor

test_transforms:
  - class_path: pointsuite.data.transforms.CenterShift
  - class_path: pointsuite.data.transforms.Collect
    init_args:
      keys: ['coord', 'class']
      feat_keys:
        feat: ['coord', 'echo']
  - class_path: pointsuite.data.transforms.ToTensor

predict_transforms:
  - class_path: pointsuite.data.transforms.CenterShift
  - class_path: pointsuite.data.transforms.Collect
    init_args:
      keys: ['coord', 'indices', 'bin_file', 'bin_path', 'pkl_path']
      feat_keys:
        feat: ['coord', 'echo']
  - class_path: pointsuite.data.transforms.ToTensor
