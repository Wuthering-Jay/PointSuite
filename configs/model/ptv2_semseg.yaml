# PointTransformerV2 语义分割模型配置
#
# PTv2 是一个高效的点云 Transformer 架构
# 使用 Grid Pooling 实现层次化特征提取

# ========================================================================
# Backbone: PointTransformerV2
# ========================================================================
backbone:
  class_path: pointsuite.models.PointTransformerV2
  init_args:
    # 输入配置
    in_channels: 5  # coord(3) + echo(2)
    
    # Patch Embedding
    patch_embed_depth: 1
    patch_embed_channels: 24
    patch_embed_groups: 6
    patch_embed_neighbours: 24
    
    # Encoder 配置
    enc_depths: [2, 2, 2, 2]
    enc_channels: [48, 96, 192, 256]
    enc_groups: [6, 12, 24, 32]
    enc_neighbours: [32, 32, 32, 32]
    
    # Decoder 配置
    dec_depths: [1, 1, 1, 1]
    dec_channels: [24, 48, 96, 192]
    dec_groups: [4, 6, 12, 24]
    dec_neighbours: [32, 32, 32, 32]
    
    # Grid 配置
    grid_sizes: [1.5, 3.75, 9.375, 23.4375]
    
    # Attention 配置
    attn_qkv_bias: true
    pe_multiplier: false
    pe_bias: true
    attn_drop_rate: 0.0
    drop_path_rate: 0.3
    
    # Unpool 配置
    unpool_backend: interp

# ========================================================================
# Head: Segmentation Head
# ========================================================================
head:
  class_path: pointsuite.models.SegHead
  init_args:
    in_channels: 24  # 与 decoder 最后一层输出匹配
    num_classes: ${data.num_classes}  # 从 data 配置引用
